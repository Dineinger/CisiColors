@page "/colors/{name?}"
@using Cisi.CisiColors.Infrastructure
@inject IColorReader ColorReader

@if (status.CouldLoad)
{
    <ColorList Title=@Name Colors=@Values ColorDescriptionMode=@_colorDescriptionMode />

    <ColorMenu @bind-ShowDetails=@_showDetails />
}
else if (status.Known)
{
    <p role="alert">The color list @Name is known, but couldn't be loaded'</p>
}
else
{
    <p>The color list @Name is not known</p>
}

@code {
    [Parameter]
    public string? Name { get; set; }

    List<ColorDefinition>? Values { get; set; }

    (bool Known, bool CouldLoad) status;

    protected override async Task OnParametersSetAsync()
    {
        var colorReadingTask = Name switch
        {
            "cisi" or "cisi-colors" => ColorReader.ReadCisiColorAsync(),
            _ => null,
        };

        // end of method
        (status, Values) = await ColorReader.LoadColorsAsync(colorReadingTask);
    }

    ColorDescriptionMode _colorDescriptionMode => _showDetails ? ColorDescriptionMode.All : ColorDescriptionMode.Main;
    bool _showDetails = false;
}
